xlab="Variance", xlim= c(0, 40), ylim= c(0, 220), cex.main=1.5, cex.lab=1.2)
hist(statistics[,1],breaks=20,add=TRUE,col=rgb(0,0,1,1/6), ylim= c(0, 220))
abline(v=sigma**2,lwd=3)
abline(v=mean(statistics[,1]),col=4,lty=2,lwd=3)
abline(v=mean(statistics[,2]),col=2,lty=2,lwd=3)
legend("topright", legend=c(paste("True variance = ",sigma**2),
bquote(paste(bar(s[b])^2, " = ", .(round(mean(statistics[,2]),3)))),
bquote(paste(bar(s)^2, " = ",.(round(mean(statistics[,1]),3)))),
expression(s[b]^2),expression(s^2)),col=c("black","red","blue",rgb(1,0,0,1/6),
col=rgb(0,0,1,1/6)), lty=c(1,6,6,2,2),lwd=c(2,2,2,14,14), cex=1.2)
set.seed(123)
rep <- 1000
n <- 10
mu <- 5
sigma <- 3
samples <- array(0, c(rep,n))
statistics <- array(0,c(rep,2))
for (i in 1:rep){
samples[i,] <- rnorm(n,mu,sigma)
statistics[i,1] <- var(samples[i,])
statistics[i,2] <- statistics[i,1]*(n-1)/n
}
par (mfrow=c(1,2), oma=c(0,0,0,0))
hist(statistics[,2], breaks= 40, probability = TRUE,
xlab=expression(s[b]^2), main= bquote(s[b]^2), cex.main=1.5, cex.lab=1.2)
curve(((n)/sigma^2) * dchisq(x * ((n)/sigma^2), df = n),
add = TRUE, col="blue", lwd=2, main="N(0,1)")
hist(statistics[ ,1], breaks= 40, probability = TRUE,
xlab=expression(s^2), main= bquote(s^2), cex.main=1.5, cex.lab=1.2)
curve(((n-1)/sigma^2) * dchisq(x * ((n-1)/sigma^2), df = n - 1),
add = TRUE, col="red", lwd=2, main="N(0,1)")
#is s2 correct?
mean(statistics[,1])
sigma**2
#is sb2 correct?
mean(statistics[,2])
sigma**2
hist(statistics[,2], breaks=20, col=rgb(1,0,0,1/6),
main=expression(paste("Biasness of ",s[b]^2)),
xlab="Variance", xlim= c(0, 40), cex.main=1.5, cex.lab=1.2,probability=TRUE)
hist(statistics[,1],breaks=20,add=TRUE,col=rgb(0,0,1,1/6), probability=TRUE)
abline(v=sigma**2,lwd=3)
abline(v=mean(statistics[,1]),col=4,lty=2,lwd=3)
abline(v=mean(statistics[,2]),col=2,lty=2,lwd=3)
legend("topright", legend=c(paste("True variance = ",sigma**2),
bquote(paste(bar(s[b])^2, " = ", .(round(mean(statistics[,2]),3)))),
bquote(paste(bar(s)^2, " = ",.(round(mean(statistics[,1]),3)))),
expression(s[b]^2),expression(s^2)),col=c("black","red","blue",rgb(1,0,0,1/6),
col=rgb(0,0,1,1/6)), lty=c(1,6,6,2,2),lwd=c(2,2,2,14,14), cex=1.2)
set.seed(123)
rep <- 1000
n <- 10
mu <- 5
sigma <- 3
samples <- array(0, c(rep,n))
statistics <- array(0,c(rep,2))
for (i in 1:rep){
samples[i,] <- rnorm(n,mu,sigma)
statistics[i,1] <- var(samples[i,])
statistics[i,2] <- statistics[i,1]*(n-1)/n
}
par (mfrow=c(1,2), oma=c(0,0,0,0))
hist(statistics[,2], breaks= 40, probability = TRUE,
xlab=expression(s[b]^2), main= bquote(s[b]^2), cex.main=1.5, cex.lab=1.2)
curve(((n)/sigma^2) * dchisq(x * ((n)/sigma^2), df = n),
add = TRUE, col="blue", lwd=2, main="N(0,1)")
hist(statistics[ ,1], breaks= 40, probability = TRUE,
xlab=expression(s^2), main= bquote(s^2), cex.main=1.5, cex.lab=1.2)
curve(((n-1)/sigma^2) * dchisq(x * ((n-1)/sigma^2), df = n - 1),
add = TRUE, col="red", lwd=2, main="N(0,1)")
#is s2 correct?
mean(statistics[,1])
sigma**2
#is sb2 correct?
mean(statistics[,2])
sigma**2
hist(statistics[,2], breaks=20, col=rgb(1,0,0,1/6),
main=expression(paste("Biasness of ",s[b]^2)),
xlab="Variance", xlim= c(0, 40), cex.main=1.5, cex.lab=1.2,probability=TRUE)
hist(statistics[,1],breaks=20,add=TRUE,col=rgb(0,0,1,1/6), probability=TRUE)
abline(v=sigma**2,lwd=3)
abline(v=mean(statistics[,1]),col=4,lty=2,lwd=3)
abline(v=mean(statistics[,2]),col=2,lty=2,lwd=3)
legend("topright", legend=c(paste("True variance = ",sigma**2),
bquote(paste(bar(s[b])^2, " = ", .(round(mean(statistics[,2]),3)))),
bquote(paste(bar(s)^2, " = ",.(round(mean(statistics[,1]),3)))),
expression(s[b]^2),expression(s^2)),col=c("black","red","blue",rgb(1,0,0,1/6),
col=rgb(0,0,1,1/6)), lty=c(1,6,6,2,2),lwd=c(2,2,2,14,14), cex=1.2)
library(MASS)
library(knitr)
local({
hook_plot = knit_hooks$get('plot')
knit_hooks$set(plot = function(x, options) {
paste0('\n\n----\n\n', hook_plot(x, options))
})
})
set.seed(101)
auto_cor <- function(n=51){
y1 <- rnorm(n=51)
y <- y1[-1] + y1[-n]
y
}
set.seed(101)
auto_cor <- function(n=51){
y1 <- rnorm(n=51)
y <- y1[-1] + y1[-n]
y
}
av <- numeric(25)
v <- numeric(25)
for (j in 1:25){
y <- auto_cor()
av[j] <- mean(y)
v[j] <- var(y)
}
print(paste("variance of the sample mean: ",var(av)))
print(paste("sample variance / n: ", mean(v)/25))
>>>>>>> 8c69ad4cb9416fd202224061d589c32358bed51a
set.seed(0);
Pb <- matrix(c(0.6, 0.2, 0.2,
0.2, 0.4, 0.4,
0.4, 0.3, 0.3), nrow = 3, ncol = 3, byrow = TRUE)
Markov = function(R, init, Mat ){
chain = numeric(R)
chain[1] = init+1
for(i in 2:R){
chain[i] = sample(x = 1:3, size =1, prob = Mat[chain[i-1], ])
}
chain - 1
}
results <- table(Markov(R= 1000, init = 0, Mat= Pb))
results
print(results/1000)
#0:Sun, 1:Cloud, 2:rain
<<<<<<< HEAD
library(DAAG)
set.seed(0);
Pb <- matrix(c(0.6, 0.2, 0.2,
0.2, 0.4, 0.4,
0.4, 0.3, 0.3), nrow = 3, ncol = 3, byrow = TRUE)
Markov = function(R, init, Mat ){
chain = numeric(R)
chain[1] = init+1
for(i in 2:R){
chain[i] = sample(x = 1:3, size =1, prob = Mat[chain[i-1], ])
}
chain - 1
}
results <- table(Markov(R= 100000, init = 0, Mat= Pb))
results
print(results/100000)
#0:Sun, 1:Cloud, 2:rain
library(Matrix)
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.4, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('state.1', 'state.2', 'state.3')
pi
#ref https://stephens999.github.io/fiveMinuteStats/stationary_distribution.html
library(Matrix)
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.4, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('state.1', 'state.2', 'state.3')
pi
#ref https://stephens999.github.io/fiveMinuteStats/stationary_distribution.html
plotmarkov(window = 10 title = "10000 with width = 10")
plotmarkov(window = 10 title = paste("10000 with width = 10"))
library(zoo)
library(lattice)
plotmarkov <- function(n=10000, start=0, window=100, transition=Pb, npanels=5){
xc2 <- Markov(n, start, transition)
mav0 <- rollmean(as.integer(xc2==0), window)
mav1 <- rollmean(as.integer(xc2==0), window)
npanel <- cut(1:length(mav0), breaks=seq(from=1, to=length(mav0),
length=npanels+1), include.lowest=TRUE)
df <- data.frame(av0=mav0, av1=mav1, x=1:length(mav0),
gp=npanel)
print(xyplot(av0+av1 ~ x | gp, data=df, layout=c(1,npanels),
type="l", par.strip.text=list(cex=0.65),
scales=list(x=list(relation="free"))))
}
plotmarkov(window = 10 title = paste("10000 with width = 10"))
plotmarkov(window = 10 ,title = paste("10000 with width = 10"))
=======
>>>>>>> 8c69ad4cb9416fd202224061d589c32358bed51a
library(zoo)
library(lattice)
plotmarkov <- function(n=10000, start=0, window=100, transition=Pb, npanels=5){
xc2 <- Markov(n, start, transition)
mav0 <- rollmean(as.integer(xc2==0), window)
mav1 <- rollmean(as.integer(xc2==0), window)
npanel <- cut(1:length(mav0), breaks=seq(from=1, to=length(mav0),
length=npanels+1), include.lowest=TRUE)
df <- data.frame(av0=mav0, av1=mav1, x=1:length(mav0),
gp=npanel)
print(xyplot(av0+av1 ~ x | gp, data=df, layout=c(1,npanels),
type="l", par.strip.text=list(cex=0.65),
scales=list(x=list(relation="free"))))
}
plotmarkov(window = 10)
plotmarkov(window = 100)
plotmarkov(window = 1000)
plotmarkov(n=1000, window = 10)
plotmarkov(n=1000, window = 100)
<<<<<<< HEAD
library(zoo)
library(lattice)
plotmarkov <- function(n=10000, start=0, window=100, transition=Pb, npanels=5){
xc2 <- Markov(n, start, transition)
mav0 <- rollmean(as.integer(xc2==0), window)
mav1 <- rollmean(as.integer(xc2==0), window)
npanel <- cut(1:length(mav0), breaks=seq(from=1, to=length(mav0),
length=npanels+1), include.lowest=TRUE)
df <- data.frame(av0=mav0, av1=mav1, x=1:length(mav0),
gp=npanel)
print(xyplot(av0+av1 ~ x | gp, data=df, layout=c(1,npanels),
type="l", par.strip.text=list(cex=0.65),
scales=list(x=list(relation="free"))))
}
plotmarkov(window = 100)
plotmarkov(window = 1000)
plotmarkov(window = 5000)
plotmarkov(n=10000, window = 1000)
plotmarkov(n=10000, window = 5000)
set.seed(0);
Pb <- matrix(c(0.6, 0.2, 0.2,
0.2, 0.4, 0.4,
0.4, 0.3, 0.3), nrow = 3, ncol = 3, byrow = TRUE)
Markov = function(R, init, Mat ){
chain = numeric(R)
chain[1] = init+1
for(i in 2:R){
chain[i] = sample(x = 1:3, size =1, prob = Mat[chain[i-1], ])
}
chain - 1
}
results <- table(Markov(R= 1000, init = 0, Mat= Pb))
results
print(results/1000)
#0:Sun, 1:Cloud, 2:rain
library(Matrix)
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.4, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('sun', 'cloud', 'rain')
pi
#ref https://stephens999.github.io/fiveMinuteStats/stationary_distribution.html
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.4, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('sun', 'cloud', 'rain')
pi
#ref https://stephens999.github.io/fiveMinuteStats/stationary_distribution.html
options(digits=3)
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.4, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('sun', 'cloud', 'rain')
pi
#ref https://stephens999.github.io/fiveMinuteStats/stationary_distribution.html
options(digits=3)
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.4, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('sun', 'cloud', 'rain')
pi
#ref https://stephens999.github.io/fiveMinuteStats/stationary_distribution.html
options(digits=3)
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.4, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('sun', 'cloud', 'rain')
pi
#ref https://stephens999.github.io/fiveMinuteStats/stationary_distribution.html
solve(A,b)
solve(a) %*% b
solve(A) %*% b
options(digits=3)
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.4, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('sun', 'cloud', 'rain')
pi
solve(A)
solve(A,b)
A
b
pi
?solve
c(3/7, 2/7, 2/7)
set.seed(0);
Pb <- matrix(c(0.6, 0.2, 0.2,
0.2, 0.4, 0.4,
0.4, 0.3, 0.3), nrow = 3, ncol = 3, byrow = TRUE)
Markov = function(R, init, Mat ){
chain = numeric(R)
chain[1] = init+1
for(i in 2:R){
chain[i] = sample(x = 1:3, size =1, prob = Mat[chain[i-1], ])
}
chain - 1
}
results <- table(Markov(R= 1000, init = 0, Mat= Pb))
results
print(results/1000)
#0:Sun, 1:Cloud, 2:rain
=======
data <- c(87, 53, 72, 90, 78, 85, 83)
rep <- 1000
samples <- matrix(rpois(7*rep,78),ncol=7)
means <- apply(samples,1,mean)
variances <- apply(samples,1,var)
# plot histograms of simulated sample mean and sample variance
# plot also a red line for the observed values
par(mfrow=c(1,2))
{
hist(means,breaks=20,main="sample mean of poisson")
abline(v=mean(data),col=2)
hist(variances,breaks=20,main="sample variance of poisson")
abline(v=var(data),col=2)
}
#var ~ (n-1)*s2/lambda ~ chi(n-1)
chi_obs <- var(data)*6/78.3
a <- 1-pchisq(chi_obs,6)
print(paste("p-value for the sample mean: ",a))
# mean ~ N(lambda,lambda/n)
a <- 2*pnorm(-abs(mean(data)-78.3),0,78.3/7)
print(paste("p-value for the sample variance: ",a))
>>>>>>> 8c69ad4cb9416fd202224061d589c32358bed51a
library(MASS)
library(knitr)
local({
hook_plot = knit_hooks$get('plot')
knit_hooks$set(plot = function(x, options) {
paste0('\n\n----\n\n', hook_plot(x, options))
})
})
library(Matrix)
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.4, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('state.1', 'state.2', 'state.3')
pi
#ref https://stephens999.github.io/fiveMinuteStats/stationary_distribution.html
option(results=5)
options(results=5)
options(results=5)
library(Matrix)
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.4, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('state.1', 'state.2', 'state.3')
pi
#ref https://stephens999.github.io/fiveMinuteStats/stationary_distribution.html
options(digits=3)
options(digits=3)
library(Matrix)
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.4, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('state.1', 'state.2', 'state.3')
pi
#ref https://stephens999.github.io/fiveMinuteStats/stationary_distribution.html
Pb <- matrix(nrow = 3, ncol = 3, byrow = TRUE, data = c(.6,.2,.2,.2,.4,.4,.4,.3,.3),
dimnames = list(c("Sun", "Cloud", "Rain"), c("Sun", "Cloud", "Rain")))
a %*% Pb = a
a = c()
a
a = a %*% Pb
a = c(3/7, 2/7, 2/7)
a %*% Pb
a
a = c()
options(digits=3)
library(Matrix)
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.4, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('sun', 'cloud', 'rain')
pi
results <- table(Markov(R= 100000, init = 0, Mat= Pb))
set.seed(0);
Pb <- matrix(c(0.6, 0.2, 0.2,
0.2, 0.4, 0.4,
0.4, 0.3, 0.3), nrow = 3, ncol = 3, byrow = TRUE)
Markov = function(R, init, Mat ){
chain = numeric(R)
chain[1] = init+1
for(i in 2:R){
chain[i] = sample(x = 1:3, size =1, prob = Mat[chain[i-1], ])
}
chain - 1
}
results <- table(Markov(R= 1000, init = 0, Mat= Pb))
results
print(results/1000)
#0:Sun, 1:Cloud, 2:rain
options(digits=3)
library(Matrix)
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.4, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('sun', 'cloud', 'rain')
pi
results <- table(Markov(R= 100000, init = 0, Mat= Pb))
results
print(results/100000)
#ref https://stephens999.github.io/fiveMinuteStats/stationary_distribution.html
options(digits=3)
library(Matrix)
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.3, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('sun', 'cloud', 'rain')
pi
results <- table(Markov(R= 100000, init = 0, Mat= Pb))
results
print(results/100000)
#ref https://stephens999.github.io/fiveMinuteStats/stationary_distribution.html
options(digits=3)
library(Matrix)
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.3, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('sun', 'cloud', 'rain')
pi
results <- table(Markov(R= 100000, init = 0, Mat= Pb))
results
print(results/100000)
#ref https://stephens999.github.io/fiveMinuteStats/stationary_distribution.html
options(digits=3)
library(Matrix)
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.3, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('sun', 'cloud', 'rain')
cat("Result of theoretical stationary distributions:\n", pi)
results <- table(Markov(R= 100000, init = 0, Mat= Pb))
cat("Result of increased simulation size:\n",result/100000)
options(digits=3)
library(Matrix)
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.3, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('sun', 'cloud', 'rain')
cat("Result of theoretical stationary distributions:\n", pi)
results <- table(Markov(R= 100000, init = 0, Mat= Pb))
cat("Result of increased simulation size:\n",results/100000)
options(digits=3)
library(Matrix)
A        <- matrix(nrow = 4, ncol = 3, byrow = TRUE, data = c(c(-0.4, 0.2, 0.4, 0.2, -0.6, 0.3, 0.2, 0.4, -0.7, 1, 1, 1 )))
b        <- c(0,0,0,1)
rank.A   <- as.numeric(rankMatrix(A))
rank.Ab  <- as.numeric(rankMatrix(cbind(A,b)))
print(paste("The rank of A =", rank.A, "and the rank of the augmented matrix =", rank.Ab))
pi        <- drop(solve(t(A) %*% A, t(A) %*% b))
names(pi) <- c('sun', 'cloud', 'rain')
cat("Result of theoretical stationary distributions:\n", pi)
results <- table(Markov(R= 100000, init = 0, Mat= Pb))
cat("\nResult of increased simulation size:\n",results/100000)
